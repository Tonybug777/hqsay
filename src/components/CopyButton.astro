---
interface Props {
  text: string;
}
const { text } = Astro.props;
---

<div class="copy-container">
  <code class="copy-text">{text}</code>

  <button
    class="copy-button"
    aria-label={`Copy "${text}" to clipboard`}
    title="Copy to clipboard"
    onclick={`copyToClipboard(${JSON.stringify(text)}, this)`}
  >
    <!-- é»˜è®¤å¤åˆ¶å›¾æ ‡ -->
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
    </svg>
  </button>
</div>

<script is:inline>
  function copyToClipboard(text, btn) {
    navigator.clipboard.writeText(text).then(() => {
      // æˆåŠŸï¼šæ˜¾ç¤ºå¯¹å‹¾
      btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
      setTimeout(() => {
        // æ¢å¤åŸå§‹å›¾æ ‡
        btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>';
      }, 2000);
    }).catch(() => {
      // å¤±è´¥ï¼šæ˜¾ç¤ºè­¦å‘Š
      btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>';
      setTimeout(() => {
        btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>';
      }, 2000);
    });
  }
</script>

<style>
.copy-container {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
  /* å®¹å™¨æœ¬èº«ä¸éœ€è¦ scrollbar-width */
}

.copy-text {
  padding: 6px 10px;
  background: #f8f8f8;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: 14px;
  max-width: 45vw;
  /* ğŸ”‘ å…³é”®ä¿®æ”¹å¼€å§‹ */
  white-space: nowrap;
  overflow-x: auto;      /* å¯ç”¨æ¨ªå‘æ»šåŠ¨ */
  overflow-y: hidden;    /* é˜²æ­¢å‚ç›´æ»šåŠ¨ */
  -ms-overflow-style: none;  /* éšè— IE/Edge æ»šåŠ¨æ¡ */
  scrollbar-width: none;     /* éšè— Firefox æ»šåŠ¨æ¡ */
  color: #333;
}

/* éšè— Chrome/Safari çš„æ»šåŠ¨æ¡ */
.copy-text::-webkit-scrollbar {
  display: none;
}

.copy-button {
  background: transparent;
  border: 1px solid #ccc;
  border-radius: 4px;
  width: 26px;
  height: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: #555;
  padding: 0;
  margin: 0;
  transition: color 0.2s, border-color 0.2s;
}

.copy-button:hover {
  color: #517e94;
  border-color: #517e94;
}

/* æš—è‰²æ¨¡å¼é€‚é… */
@media (prefers-color-scheme: dark) {
  .copy-text {
    background: #2d2d2d;
    border-color: #555;
    color: #eee;
  }
  .copy-button {
    border-color: #666;
    color: #aaa;
  }
  .copy-button:hover {
    color: #517e94;
    border-color: #517e94;
  }
}
</style>